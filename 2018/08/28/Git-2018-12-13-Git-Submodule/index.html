<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/blog/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/blog/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Git,Submodule,">





  <link rel="alternate" href="/blog/atom.xml" title="Leroscox Blog" type="application/atom+xml">






<meta name="description" content="运行环境 Git 2.18.0.windows.1 Running on Win7x64 参考文章 咖啡兔 : Git Submodule使用完整教程 参考资料 stackoverflow : How to read the mode field of git-ls-tree’s output Curious git : How do git submodules work? Curious g">
<meta name="keywords" content="Git,Submodule">
<meta property="og:type" content="article">
<meta property="og:title" content="Git Submodule">
<meta property="og:url" content="https://gay.hen-tai.top/blog/2018/08/28/Git-2018-12-13-Git-Submodule/index.html">
<meta property="og:site_name" content="Leroscox Blog">
<meta property="og:description" content="运行环境 Git 2.18.0.windows.1 Running on Win7x64 参考文章 咖啡兔 : Git Submodule使用完整教程 参考资料 stackoverflow : How to read the mode field of git-ls-tree’s output Curious git : How do git submodules work? Curious g">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-01-11T02:39:53.295Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Git Submodule">
<meta name="twitter:description" content="运行环境 Git 2.18.0.windows.1 Running on Win7x64 参考文章 咖啡兔 : Git Submodule使用完整教程 参考资料 stackoverflow : How to read the mode field of git-ls-tree’s output Curious git : How do git submodules work? Curious g">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://gay.hen-tai.top/blog/2018/08/28/Git-2018-12-13-Git-Submodule/">





  <title>Git Submodule | Leroscox Blog</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Leroscox Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">TX今天倒闭了吗？</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/blog/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gay.hen-tai.top/blog/blog/2018/08/28/Git-2018-12-13-Git-Submodule/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="MiK">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leroscox Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Git Submodule</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-28T11:12:13+08:00">
                2018-08-28
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Develop/" itemprop="url" rel="index">
                    <span itemprop="name">Develop</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Develop/Tools/" itemprop="url" rel="index">
                    <span itemprop="name">Tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p><strong>运行环境</strong></p>
<p>Git 2.18.0.windows.1 <strong>Running on</strong> Win7x64</p>
<p><strong>参考文章</strong></p>
<p><a href="http://www.kafeitu.me/git/2012/03/27/git-submodule.html" target="_blank" rel="noopener">咖啡兔 : Git Submodule使用完整教程</a></p>
<p><strong>参考资料</strong></p>
<p><a href="https://stackoverflow.com/questions/737673/how-to-read-the-mode-field-of-git-ls-trees-output" target="_blank" rel="noopener">stackoverflow : How to read the mode field of git-ls-tree’s output</a></p>
<p><a href="https://matthew-brett.github.io/curious-git/git_submodules.html" target="_blank" rel="noopener">Curious git : How do git submodules work?</a></p>
<p><a href="https://matthew-brett.github.io/curious-git/git_object_types.html" target="_blank" rel="noopener">Curious git : Types of git objects</a></p>
<p><a href="https://matthew-brett.github.io/curious-git/curious_git.html" target="_blank" rel="noopener">Curious git : Curious git</a></p>
</blockquote>
<p><strong>Git Submodule功能刚刚开始学习可能觉得有点怪异，本文将把命令行每一步操作的命令和结果都展现出来，以便更好的理解。</strong></p>
<a id="more"></a>
<h2 id="1-对于共用资源的处理方式（为什么要使用Git-Submodule？）"><a href="#1-对于共用资源的处理方式（为什么要使用Git-Submodule？）" class="headerlink" title="1.对于共用资源的处理方式（为什么要使用Git Submodule？）"></a>1.对于共用资源的处理方式（为什么要使用Git Submodule？）</h2><p>每个公司的系统都会有一套统一的系统风格，或者针对某一个大客户的多个系统风格保持统一，而且如果风格改动后要同步到多个系统中；这样的需求几乎每个开发人员都遇到，下面看看各个层次的程序员怎么处理：</p>
<p>假如对于系统的风格需要几个目录：css、images、js。</p>
<ul>
<li><p>普通程序员，把最新版本的代码逐个复制到每个项目中，如果有N个项目，那就是要复制N x 3次；如果漏掉了某个文件夹没有复制…@（&amp;#@#。</p>
</li>
<li><p>文艺程序员，使用Git Submodule功能，执行：git submodule update，然后冲一杯咖啡悠哉的享受着。</p>
</li>
</ul>
<hr>
<p>引用一段《Git权威指南》的话： 项目的版本库在某些情况虾需要引用其他版本库中的文件，例如公司积累了一套常用的函数库，被多个项目调用，显然这个函数库的代码不能直接放到某个项目的代码中，而是要独立为一个代码库，那么其他项目要调用公共函数库该如何处理呢？分别把公共函数库的文件拷贝到各自的项目中会造成冗余，丢弃了公共函数库的维护历史，这显然不是好的方法。</p>
<hr>
<h2 id="2-如何使用Git-Submodule"><a href="#2-如何使用Git-Submodule" class="headerlink" title="2.如何使用Git Submodule"></a>2.如何使用Git Submodule</h2><blockquote>
<p>本例通过模拟<strong>一个项目</strong>及<strong>两个公共类库</strong>来学习。</p>
</blockquote>
<h3 id="2-1-准备工作"><a href="#2-1-准备工作" class="headerlink" title="2.1 准备工作"></a>2.1 准备工作</h3><h4 id="2-1-1-建立三个版本库"><a href="#2-1-1-建立三个版本库" class="headerlink" title="2.1.1 建立三个版本库"></a>2.1.1 建立三个版本库</h4><blockquote>
<p>可以在本地也可以在远程的“远程仓库”（lib1.git，lib2.git，pr.git）<br>本文就建立在本地了…</p>
</blockquote>
<ol>
<li><p>建立目录结构</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ mkdir remote</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ <span class="built_in">cd</span> remote/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote</span><br><span class="line">$ mkdir lib1.git</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote</span><br><span class="line">$ mkdir lib2.git</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote</span><br><span class="line">$ mkdir pr.git</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote</span><br><span class="line">$ ls -a</span><br><span class="line">./  ../  lib1.git/  lib2.git/  pr.git/</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化版本库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote</span><br><span class="line">$ <span class="built_in">cd</span> ./lib1.git/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote/lib1.git</span><br><span class="line">$ git --bare init</span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> D:/Work/Git/TestSubmodule/remote/lib1.git/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote/lib1.git (BARE:master)</span><br><span class="line">$ <span class="built_in">cd</span> ../lib2.git/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote/lib2.git</span><br><span class="line">$ git --bare init</span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> D:/Work/Git/TestSubmodule/remote/lib2.git/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote/lib2.git (BARE:master)</span><br><span class="line">$ <span class="built_in">cd</span> ../pr.git/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote/pr.git</span><br><span class="line">$ git --bare init</span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> D:/Work/Git/TestSubmodule/remote/pr.git</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-1-2-建立lib1，lib2，pr本地仓库"><a href="#2-1-2-建立lib1，lib2，pr本地仓库" class="headerlink" title="2.1.2 建立lib1，lib2，pr本地仓库"></a>2.1.2 建立lib1，lib2，pr本地仓库</h4><blockquote>
<p>此处通过克隆版本库快速建立本地仓库与版本库的联系</p>
</blockquote>
<ol>
<li><p>建立目录结构</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/remote/pr.git (BARE:master)</span><br><span class="line">$ <span class="built_in">cd</span> ../../</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ mkdir -p libs/lib1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ mkdir -p libs/lib2</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ mkdir pr</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ ls -a</span><br><span class="line">./  ../  libs/  pr/  remote/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ ls -a ./libs</span><br><span class="line">./  ../  lib1/  lib2/</span><br></pre></td></tr></table></figure>
</li>
<li><p>（通过克隆）建立本地仓库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ git <span class="built_in">clone</span> /d/Work/Git/TestSubmodule/remote/lib1.git ./libs/lib1/</span><br><span class="line">Cloning into <span class="string">'./libs/lib1'</span>...</span><br><span class="line">warning: You appear to have cloned an empty repository.</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ git <span class="built_in">clone</span> /d/Work/Git/TestSubmodule/remote/lib2.git ./libs/lib2/</span><br><span class="line">Cloning into <span class="string">'./libs/lib2'</span>...</span><br><span class="line">warning: You appear to have cloned an empty repository.</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ git <span class="built_in">clone</span> /d/Work/Git/TestSubmodule/remote/pr.git ./pr</span><br><span class="line">Cloning into <span class="string">'./pr'</span>...</span><br><span class="line">warning: You appear to have cloned an empty repository.</span><br><span class="line"><span class="keyword">done</span>.</span><br></pre></td></tr></table></figure>
</li>
<li><p>为三个仓库都添加一点东西并<strong>提交并推送</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ <span class="built_in">cd</span> ./libs/lib1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ git config user.name <span class="string">"lib1"</span></span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ git config user.email  <span class="string">"lib1@."</span></span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line"></span><br><span class="line">No commits yet</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to include <span class="keyword">in</span> what will be committed)</span><br><span class="line"></span><br><span class="line">	l1.md</span><br><span class="line"></span><br><span class="line">nothing added to commit but untracked files present (use <span class="string">"git add"</span> to track)</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ git add .</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ git commit -am <span class="string">"init lib1 v0.1"</span></span><br><span class="line">[master (root-commit) e32323b] init lib1 v0.1</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br><span class="line"> create mode 100644 l1.md</span><br><span class="line"> </span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ git push</span><br><span class="line">Enumerating objects: 3, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 203 bytes | 203.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To D:/Work/Git/TestSubmodule/remote/lib1.git</span><br><span class="line"> * [new branch]      master -&gt; master</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>lib2 添加文件 l2.md<br>pr 添加文件 p.md<br>步骤同上，略</p>
</blockquote>
<h3 id="2-2-在项目中添加Submodules"><a href="#2-2-在项目中添加Submodules" class="headerlink" title="2.2 在项目中添加Submodules"></a>2.2 在项目中添加Submodules</h3><h4 id="2-2-1-添加Submodules"><a href="#2-2-1-添加Submodules" class="headerlink" title="2.2.1 添加Submodules"></a>2.2.1 添加Submodules</h4><ol>
<li><p>添加lib1到指定位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git submodule add /d/Work/Git/TestSubmodule/remote/lib1.git ./libs/lib1</span><br><span class="line"><span class="comment"># 从该行可以看到lib1被clone到了指定的libs/lib1目录下</span></span><br><span class="line">Cloning into <span class="string">'D:/Work/Git/TestSubmodule/pr/libs/lib1'</span>...</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line">warning: LF will be replaced by CRLF <span class="keyword">in</span> .gitmodules.</span><br><span class="line">The file will have its original line endings <span class="keyword">in</span> your working directory.</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加lib2但不指定位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git submodule add /d/Work/Git/TestSubmodule/remote/lib2.git/</span><br><span class="line"><span class="comment"># 从该行可以看到lib2别clone到了默认的当前目录下的lib2中</span></span><br><span class="line">Cloning into <span class="string">'D:/Work/Git/TestSubmodule/pr/lib2'</span>...</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line">warning: LF will be replaced by CRLF <span class="keyword">in</span> .gitmodules.</span><br><span class="line">The file will have its original line endings <span class="keyword">in</span> your working directory.</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-2-2-观察变化"><a href="#2-2-2-观察变化" class="headerlink" title="2.2.2 观察变化"></a>2.2.2 观察变化</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以看到目录下增加了</span></span><br><span class="line"><span class="comment"># 记录模块信息的.gitmodules文件</span></span><br><span class="line"><span class="comment"># 存放lib2文件的lib2目录</span></span><br><span class="line"><span class="comment"># 指定存放lib1文件的目录的上级目录libs</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ ls -a</span><br><span class="line">./  ../  .git/  .gitmodules  lib2/  libs/  p.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看.gitmodules内容</span></span><br><span class="line"><span class="comment"># 可以看到该文件记录了模块的位置和来源信息</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ cat .gitmodules</span><br><span class="line">[submodule <span class="string">"libs/lib1"</span>]</span><br><span class="line">	path = libs/lib1</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib1.git</span><br><span class="line">[submodule <span class="string">"lib2"</span>]</span><br><span class="line">	path = lib2</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib2.git/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看项目/.git/config文件</span></span><br><span class="line"><span class="comment"># 可以看到模块信息已经注册到了config中</span></span><br><span class="line"><span class="comment"># （与网络上某些教程所描述的</span></span><br><span class="line"><span class="comment"># git submodule add 不会注册到config中，需要再 git submodule init</span></span><br><span class="line"><span class="comment"># 不符，可能是git版本差异）</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ cat ./.git/config</span><br><span class="line">[core]</span><br><span class="line">	repositoryformatversion = 0</span><br><span class="line">	filemode = <span class="literal">false</span></span><br><span class="line">	bare = <span class="literal">false</span></span><br><span class="line">	logallrefupdates = <span class="literal">true</span></span><br><span class="line">	symlinks = <span class="literal">false</span></span><br><span class="line">	ignorecase = <span class="literal">true</span></span><br><span class="line">[remote <span class="string">"origin"</span>]</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/pr.git</span><br><span class="line">	fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line">[branch <span class="string">"master"</span>]</span><br><span class="line">	remote = origin</span><br><span class="line">	merge = refs/heads/master</span><br><span class="line">[user]</span><br><span class="line">	name = pr</span><br><span class="line">	email = pr@.</span><br><span class="line">[submodule <span class="string">"libs/lib1"</span>]</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib1.git</span><br><span class="line">	active = <span class="literal">true</span></span><br><span class="line">[submodule <span class="string">"lib2"</span>]</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib2.git/</span><br><span class="line">	active = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入并查看lib1目录</span></span><br><span class="line"><span class="comment"># 可以看到lib1的l1.md文件</span></span><br><span class="line"><span class="comment"># 以及一个.git文件</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ <span class="built_in">cd</span> libs/lib1/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/libs/lib1 (master)</span><br><span class="line">$ ls -a</span><br><span class="line">./  ../  .git  l1.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看.git文件可以发现这是一个指向其他目录的“链接”</span></span><br><span class="line"><span class="comment"># 在Linux上可以通过它访问它指向的目录</span></span><br><span class="line"><span class="comment"># 但在Windows上就体现为了一个文件</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/libs/lib1 (master)</span><br><span class="line">$ cat .git</span><br><span class="line">gitdir: ../../.git/modules/libs/lib1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/libs/lib1 (master)</span><br><span class="line">$ <span class="built_in">cd</span> .git</span><br><span class="line">bash: <span class="built_in">cd</span>: .git: Not a directory</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入这个“链接”指向的目录</span></span><br><span class="line"><span class="comment"># 可以发现这个目录是存放在当前项目的版本库中的lib1的版本库</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/libs/lib1 (master)</span><br><span class="line">$ <span class="built_in">cd</span> ../../.git/modules/libs/lib1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/.git/modules/libs/lib1 (master)</span><br><span class="line">$ ls -a</span><br><span class="line">./   config       HEAD    index  logs/     packed-refs</span><br><span class="line">../  description  hooks/  info/  objects/  refs/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看其HEAD指针</span></span><br><span class="line"><span class="comment"># 指向了master</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/.git/modules/libs/lib1 (master)</span><br><span class="line">$ cat HEAD</span><br><span class="line">ref: refs/heads/master</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看master</span></span><br><span class="line"><span class="comment"># 指向的是第一次提交（也就是当前最后一次提交）</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/.git/modules/libs/lib1 (master)</span><br><span class="line">$ cat refs/heads/master</span><br><span class="line">e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/.git/modules/libs/lib1 (master)</span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8 (HEAD -&gt; master, origin/master, origin/HEAD)</span><br><span class="line">Author: lib1 &lt;lib1@&gt;</span><br><span class="line">Date:   Fri Aug 17 21:59:54 2018 +0800</span><br><span class="line"></span><br><span class="line">    init lib1 v0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回项目目录</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/.git/modules/libs/lib1 (master)</span><br><span class="line">$ <span class="built_in">cd</span> /d/Work/Git/TestSubmodule/pr</span><br><span class="line"></span><br><span class="line"><span class="comment"># #####</span></span><br><span class="line"><span class="comment"># 查看项目状态及改动</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use <span class="string">"git reset HEAD &lt;file&gt;..."</span> to unstage)</span><br><span class="line"></span><br><span class="line">	new file:   .gitmodules</span><br><span class="line">	new file:   lib2</span><br><span class="line">	new file:   libs/lib1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git diff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 请留意此处的变化</span></span><br><span class="line"><span class="comment"># 第一个变化是.gitmodules文件，文件模式为100644，表明一个普通文件，后面跟随着文本改动。</span></span><br><span class="line"><span class="comment"># 第二个与第三个是目录（并非普通文件），文件模式为160000，后面也记录着一个改动，内容是是模块当前版本的commit id（一个hash值）。</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git diff --cached</span><br><span class="line">diff --git a/.gitmodules b/.gitmodules</span><br><span class="line">new file mode 100644</span><br><span class="line">index 0000000..7896297</span><br><span class="line">--- /dev/null</span><br><span class="line">+++ b/.gitmodules</span><br><span class="line">@@ -0,0 +1,6 @@</span><br><span class="line">+[submodule <span class="string">"libs/lib1"</span>]</span><br><span class="line">+       path = libs/lib1</span><br><span class="line">+       url = D:/Work/Git/TestSubmodule/remote/lib1.git</span><br><span class="line">+[submodule <span class="string">"lib2"</span>]</span><br><span class="line">+       path = lib2</span><br><span class="line">+       url = D:/Work/Git/TestSubmodule/remote/lib2.git/</span><br><span class="line">diff --git a/lib2 b/lib2</span><br><span class="line">new file mode 160000</span><br><span class="line">index 0000000..a2b0f7a</span><br><span class="line">--- /dev/null</span><br><span class="line">+++ b/lib2</span><br><span class="line">@@ -0,0 +1 @@</span><br><span class="line">+Subproject commit a2b0f7ac5f0f2cfe8f57dd24e7b6ab27922d6d7d</span><br><span class="line">diff --git a/libs/lib1 b/libs/lib1</span><br><span class="line">new file mode 160000</span><br><span class="line">index 0000000..e32323b</span><br><span class="line">--- /dev/null</span><br><span class="line">+++ b/libs/lib1</span><br><span class="line">@@ -0,0 +1 @@</span><br><span class="line">+Subproject commit e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8</span><br></pre></td></tr></table></figure>
<h4 id="2-2-3-commit-amp-push"><a href="#2-2-3-commit-amp-push" class="headerlink" title="2.2.3 commit &amp; push"></a>2.2.3 commit &amp; push</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意 lib2 与 libs/lib1 记录的 160000 模式。</span></span><br><span class="line"><span class="comment"># 这是 Git 中的一种特殊模式</span></span><br><span class="line"><span class="comment"># 它本质上将一个提交记作一项目录记录的，而非一个子目录或者一个文件。</span></span><br><span class="line"><span class="comment"># 提交成功即确定下项目这一版本所添加的Submodules的版本。</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git commit -am <span class="string">"import: lib1 to ./libs/lib1, lib2 to ./lib2 (default path)"</span></span><br><span class="line">[master 42a346a] import: lib1 to ./libs/lib1, lib2 to ./lib2 (default path)</span><br><span class="line"> 3 files changed, 8 insertions(+)</span><br><span class="line"> create mode 100644 .gitmodules</span><br><span class="line"> create mode 160000 lib2</span><br><span class="line"> create mode 160000 libs/lib1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git push</span><br><span class="line">Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 4 threads.</span><br><span class="line">Compressing objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (4/4), 471 bytes | 471.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 4 (delta 0), reused 0 (delta 0)</span><br><span class="line">To D:/Work/Git/TestSubmodule/remote/pr.git</span><br><span class="line">   48f1fd8..42a346a  master -&gt; master</span><br></pre></td></tr></table></figure>
<h3 id="2-3-Clone带有Submodules的项目（仓库）"><a href="#2-3-Clone带有Submodules的项目（仓库）" class="headerlink" title="2.3 Clone带有Submodules的项目（仓库）"></a>2.3 Clone带有Submodules的项目（仓库）</h3><h4 id="2-3-1-git-clone"><a href="#2-3-1-git-clone" class="headerlink" title="2.3.1 git clone"></a>2.3.1 git clone</h4><ul>
<li>在另一个位置克隆项目pr<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ <span class="built_in">cd</span> ..</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ git <span class="built_in">clone</span> /d/Work/Git/TestSubmodule/remote/pr.git ./pr-clone</span><br><span class="line">Cloning into <span class="string">'./pr-clone'</span>...</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ <span class="built_in">cd</span> pr-clone/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a</span><br><span class="line">./  ../  .git/  .gitmodules  lib2/  libs/  p.md</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-3-2-查看Submodules状态"><a href="#2-3-2-查看Submodules状态" class="headerlink" title="2.3.2 查看Submodules状态"></a>2.3.2 查看Submodules状态</h4><ol>
<li><p>查看.gitmodules</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 由于该文件受版本控制，因此里面的模块信息被一并克隆了下来</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ cat .gitmodules</span><br><span class="line">[submodule <span class="string">"libs/lib1"</span>]</span><br><span class="line">	path = libs/lib1</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib1.git</span><br><span class="line">[submodule <span class="string">"lib2"</span>]</span><br><span class="line">	path = lib2</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib2.git/</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看.git目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以看到克隆得到的仓库的.git/config中没有模块的注册信息</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ cat .git/config</span><br><span class="line">[core]</span><br><span class="line">	repositoryformatversion = 0</span><br><span class="line">	filemode = <span class="literal">false</span></span><br><span class="line">	bare = <span class="literal">false</span></span><br><span class="line">	logallrefupdates = <span class="literal">true</span></span><br><span class="line">	symlinks = <span class="literal">false</span></span><br><span class="line">	ignorecase = <span class="literal">true</span></span><br><span class="line">[remote <span class="string">"origin"</span>]</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/pr.git</span><br><span class="line">	fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line">[branch <span class="string">"master"</span>]</span><br><span class="line">	remote = origin</span><br><span class="line">	merge = refs/heads/master</span><br><span class="line"></span><br><span class="line"><span class="comment"># .git中没有存放模块版本控制的modules目录</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a ./.git</span><br><span class="line">./   config       HEAD    index  logs/     packed-refs</span><br><span class="line">../  description  hooks/  info/  objects/  refs/</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看模块目录下有什么</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一片空白...</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a ./libs/lib1/</span><br><span class="line">./  ../</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a ./lib2</span><br><span class="line">./  ../</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用git submodule查看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以看到模块的hash码和路径</span></span><br><span class="line"><span class="comment"># 最前面的‘-’表示该模块还未检出</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git submodule</span><br><span class="line">-a2b0f7ac5f0f2cfe8f57dd24e7b6ab27922d6d7d lib2</span><br><span class="line">-e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8 libs/lib1</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-3-2-注册并检出模块"><a href="#2-3-2-注册并检出模块" class="headerlink" title="2.3.2 注册并检出模块"></a>2.3.2 注册并检出模块</h4><ol>
<li>在当前克隆得到的仓库中注册模块</li>
</ol>
<blockquote>
<p>git submodule init 用来初始化本地配置文件</p>
<p>实际上是修改了.git/config文件，在该文件内注册了submodule库</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git submodule init</span><br><span class="line">Submodule <span class="string">'lib2'</span> (D:/Work/Git/TestSubmodule/remote/lib2.git/) registered <span class="keyword">for</span> path <span class="string">'lib2'</span></span><br><span class="line">Submodule <span class="string">'libs/lib1'</span> (D:/Work/Git/TestSubmodule/remote/lib1.git) registered <span class="keyword">for</span> path <span class="string">'libs/lib1'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注册后.git仍无modules目录</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a ./.git</span><br><span class="line">./   config       HEAD    index  logs/     packed-refs</span><br><span class="line">../  description  hooks/  info/  objects/  refs/</span><br><span class="line"></span><br><span class="line"><span class="comment"># config中有了模块的信息</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ cat ./.git/config</span><br><span class="line">[core]</span><br><span class="line">	repositoryformatversion = 0</span><br><span class="line">	filemode = <span class="literal">false</span></span><br><span class="line">	bare = <span class="literal">false</span></span><br><span class="line">	logallrefupdates = <span class="literal">true</span></span><br><span class="line">	symlinks = <span class="literal">false</span></span><br><span class="line">	ignorecase = <span class="literal">true</span></span><br><span class="line">[remote <span class="string">"origin"</span>]</span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/pr.git</span><br><span class="line">	fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line">[branch <span class="string">"master"</span>]</span><br><span class="line">	remote = origin</span><br><span class="line">	merge = refs/heads/master</span><br><span class="line">[submodule <span class="string">"lib2"</span>]</span><br><span class="line">	active = <span class="literal">true</span></span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib2.git/</span><br><span class="line">[submodule <span class="string">"libs/lib1"</span>]</span><br><span class="line">	active = <span class="literal">true</span></span><br><span class="line">	url = D:/Work/Git/TestSubmodule/remote/lib1.git</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>检出模块</li>
</ol>
<blockquote>
<p>git submodule update</p>
<p>获取该模块版本库，检查当前模块版本是否与父项目当前版本的索引中记录的该模块的版本一致，一致则不做操作；不一致则检出目标commit id，HEAD将直接指向该commit id。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git submodule update</span><br><span class="line">Cloning into <span class="string">'D:/Work/Git/TestSubmodule/pr-clone/lib2'</span>...</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line">Cloning into <span class="string">'D:/Work/Git/TestSubmodule/pr-clone/libs/lib1'</span>...</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line">Submodule path <span class="string">'lib2'</span>: checked out <span class="string">'a2b0f7ac5f0f2cfe8f57dd24e7b6ab27922d6d7d'</span></span><br><span class="line">Submodule path <span class="string">'libs/lib1'</span>: checked out <span class="string">'e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># update后.git出现了模块的版本库文件夹，模块目录下也有了对应文件</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a ./.git</span><br><span class="line">./   config       HEAD    index  logs/     objects/     refs/</span><br><span class="line">../  description  hooks/  info/  modules/  packed-refs</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a libs/lib1/</span><br><span class="line">./  ../  .git  l1.md</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ ls -a lib2</span><br><span class="line">./  ../  .git  l2.md</span><br></pre></td></tr></table></figure>
<ul>
<li>上面的两个命令(git submodule init &amp; update)其实可以简化</li>
<li>如果给 git clone 命令传递 –recursive 选项，它就会自动初始化并更新仓库中的每一个子模块。</li>
</ul>
<h3 id="2-4-修改Submodule"><a href="#2-4-修改Submodule" class="headerlink" title="2.4 修改Submodule"></a>2.4 修改Submodule</h3><p>一个项目可以在自己的仓库中修改提交了；作为模块添加到其他项目中后也可以直接在其他项目中修改提交。</p>
<h4 id="2-4-1-在引用了该模块的项目中修改（lib1为例）"><a href="#2-4-1-在引用了该模块的项目中修改（lib1为例）" class="headerlink" title="2.4.1 在引用了该模块的项目中修改（lib1为例）"></a>2.4.1 在引用了该模块的项目中修改（lib1为例）</h4><blockquote>
<p>在上一节中克隆得到的项目中修改</p>
<p>最后会将项目对模块的引用一并更新</p>
</blockquote>
<ol>
<li><p>首先进入模块目录，就可以查看模块版本状态（相当于进入了另一个仓库）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ <span class="built_in">cd</span> ./libs/lib1/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看出该lib1处于头指针分离状态，处在原项目提交时该模块的版本上</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 ((e32323b...))</span><br><span class="line">$ git status</span><br><span class="line">HEAD detached at e32323b</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看HEAD，直接指向原项目提交时该模块的commit id</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 ((e32323b...))</span><br><span class="line">$ cat .git</span><br><span class="line">gitdir: ../../.git/modules/libs/lib1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 ((e32323b...))</span><br><span class="line">$ cat ../../.git/modules/libs/lib1/HEAD</span><br><span class="line">e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8</span><br></pre></td></tr></table></figure>
</li>
<li><p>现在要修改lib1就需要先切换到master分支, 修改并提交（先不push）</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 ((e32323b...))</span><br><span class="line">$ git checkout master</span><br><span class="line">Switched to branch <span class="string">'master'</span></span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 (master)</span><br><span class="line">$ git diff</span><br><span class="line">diff --git a/l1.md b/l1.md</span><br><span class="line">index ebf6fdc..8bad4d8 100644</span><br><span class="line">--- a/l1.md</span><br><span class="line">+++ b/l1.md</span><br><span class="line">@@ -1,2 +1,3 @@</span><br><span class="line"> <span class="comment"># lib1</span></span><br><span class="line"> v 0.1</span><br><span class="line">+v 0.2</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 (master)</span><br><span class="line">$ git commit -am <span class="string">"IN pr-clone: update lib1 to 0.2"</span></span><br><span class="line">[master ec3c940] IN pr-clone: update lib1 to 0.2</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>在push前先看一下pr-clone的状态</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当前项目中的模块 libs/lib1 发生变化（即该模块有提交产生了新版本）</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 (master)</span><br><span class="line">$ <span class="built_in">cd</span> ../..</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">	modified:   libs/lib1 (new commits)</span><br><span class="line"></span><br><span class="line">no changes added to commit (use <span class="string">"git add"</span> and/or <span class="string">"git commit -a"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 差异中可以看出因为模块的版本发生变化，项目对该模块的引用的版本的记录也要进行更新</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git diff</span><br><span class="line">diff --git a/libs/lib1 b/libs/lib1</span><br><span class="line">index e32323b..ec3c940 160000</span><br><span class="line">--- a/libs/lib1</span><br><span class="line">+++ b/libs/lib1</span><br><span class="line">@@ -1 +1 @@</span><br><span class="line">-Subproject commit e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8</span><br><span class="line">+Subproject commit ec3c940c4ab8406b08d0513f02955ca07bb995ef</span><br></pre></td></tr></table></figure>
<p><strong>注意：如果现在执行git submodule update操作会让 libs/lib1 还原到之前的commit id上，但是刚刚的修改已经提交到了master分支上，因此不会丢失，只要再将 libs/lib1 master分支检出即可回到修改完成的版本上</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行git submodule update使 lib1 回到了记录的 commit id 对应的版本上</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git submodule update</span><br><span class="line">Submodule path <span class="string">'libs/lib1'</span>: checked out <span class="string">'e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8'</span></span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检出 libs/lib1 master 分支来到修改后的版本上并push</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ <span class="built_in">cd</span> libs/lib1/</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 ((e32323b...))</span><br><span class="line">$ git checkout master</span><br><span class="line">Previous HEAD position was e32323b init lib1 v0.1</span><br><span class="line">Switched to branch <span class="string">'master'</span></span><br><span class="line">Your branch is ahead of <span class="string">'origin/master'</span> by 1 commit.</span><br><span class="line">  (use <span class="string">"git push"</span> to publish your <span class="built_in">local</span> commits)</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone/libs/lib1 (master)</span><br><span class="line">$ git push</span><br><span class="line">Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 260 bytes | 260.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To D:/Work/Git/TestSubmodule/remote/lib1.git</span><br><span class="line">   e32323b..ec3c940  master -&gt; master</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>将使用了新版lib1的pr-clone提交并push</li>
</ol>
<p>这时查看pr-clone的状态<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当前项目中的模块 libs/lib1 发生变化（提交产生了新版本）</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">	modified:   libs/lib1 (new commits)</span><br><span class="line"></span><br><span class="line">no changes added to commit (use <span class="string">"git add"</span> and/or <span class="string">"git commit -a"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 项目对该模块的引用的版本的记录需要更新</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git diff</span><br><span class="line">diff --git a/libs/lib1 b/libs/lib1</span><br><span class="line">index e32323b..ec3c940 160000</span><br><span class="line">--- a/libs/lib1</span><br><span class="line">+++ b/libs/lib1</span><br><span class="line">@@ -1 +1 @@</span><br><span class="line">-Subproject commit e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8</span><br><span class="line">+Subproject commit ec3c940c4ab8406b08d0513f02955ca07bb995ef</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git commit -am <span class="string">"follow lib1 v0.1 to v0.2 update"</span></span><br><span class="line">[master 331116a] follow lib1 v0.1 to v0.2 update</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ git push</span><br><span class="line">Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 4 threads.</span><br><span class="line">Compressing objects: 100% (2/2), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 362 bytes | 362.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To D:/Work/Git/TestSubmodule/remote/pr.git</span><br><span class="line">   42a346a..331116a  master -&gt; master</span><br></pre></td></tr></table></figure></p>
<h4 id="2-4-2-在模块（项目）自己的仓库中修改（lib2为例）"><a href="#2-4-2-在模块（项目）自己的仓库中修改（lib2为例）" class="headerlink" title="2.4.2 在模块（项目）自己的仓库中修改（lib2为例）"></a>2.4.2 在模块（项目）自己的仓库中修改（lib2为例）</h4><blockquote>
<p>相对于上一种修改方式，这种更为简单清晰。</p>
</blockquote>
<p>修改提交push完成！<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr-clone (master)</span><br><span class="line">$ <span class="built_in">cd</span> ../libs/lib2</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib2 (master)</span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit a2b0f7ac5f0f2cfe8f57dd24e7b6ab27922d6d7d (HEAD -&gt; master, origin/master)</span><br><span class="line">Author: lib2 &lt;lib2@&gt;</span><br><span class="line">Date:   Fri Aug 17 22:05:13 2018 +0800</span><br><span class="line"></span><br><span class="line">    init lib2 v0.1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib2 (master)</span><br><span class="line">$ git diff</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib2 (master)</span><br><span class="line">$ git diff</span><br><span class="line">diff --git a/l2.md b/l2.md</span><br><span class="line">index 5c34c87..bceab83 100644</span><br><span class="line">--- a/l2.md</span><br><span class="line">+++ b/l2.md</span><br><span class="line">@@ -1,2 +1,3 @@</span><br><span class="line"> <span class="comment"># lib2</span></span><br><span class="line"> v 0.1</span><br><span class="line">+v 0.2</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib2 (master)</span><br><span class="line">$ git commit -am <span class="string">"IN selfRepo update lib2 to 0.2"</span></span><br><span class="line">[master 772a158] IN selfRepo update lib2 to 0.2</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib2 (master)</span><br><span class="line">$ git push</span><br><span class="line">Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 253 bytes | 253.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To D:/Work/Git/TestSubmodule/remote/lib2.git</span><br><span class="line">   a2b0f7a..772a158  master -&gt; master</span><br></pre></td></tr></table></figure></p>
<h3 id="2-5-应用Submodule的修改"><a href="#2-5-应用Submodule的修改" class="headerlink" title="2.5 应用Submodule的修改"></a>2.5 应用Submodule的修改</h3><p>上一节列举了两种修改Submodule的方式，修改完成并推送后，要在以前引用了它们项目中应用这些更新。</p>
<ul>
<li>模块版本状况的判断依据来源于索引中指定模块版本的 commit id。</li>
</ul>
<p>此处有两种情况：</p>
<ol>
<li><p>项目当前版本索引中指定的模块版本已被更新：上一节中模块 lib1 更新后的版本直接被项目 pr 的克隆项目 pr-clone 引用并提交并push，那么项目 pr 拉取最新的版本后，索引中指定的模块版本已为新版，但项目中模块的文件为旧版，这时只需要在 .git/config 中已注册模块的情况下（若未注册需要执行git submodule init将模块信息注册到 .git/config 中）执行git submodule update即可将模块文件更新到指定版本了。</p>
</li>
<li><p>项目当前版本索引中指定的模块版本未被更新：上一节中模块 lib2 在自己的仓库中更新后的版本后没有被其他项目引用，项目 pr 与 pr-clone 中当前版本索引中指定的模块 lib2 的版本仍为旧版，以 pr 为例，要更新 lib2 到最新版，需要进入 pr 项目下模块 lib2 的目录里，将分支切换到所需模块版本所在的分支并拉取更新（此处为master并拉取），检出需要的模块版本（此处为master最新版），返回项目目录中提交对索引中记录的模块版本的更新。</p>
</li>
</ol>
<h4 id="2-5-1-索引中commit-id已更新"><a href="#2-5-1-索引中commit-id已更新" class="headerlink" title="2.5.1 索引中commit id已更新"></a>2.5.1 索引中commit id已更新</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取项目的更新</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git pull</span><br><span class="line">remote: Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (2/2), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">Unpacking objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">From D:/Work/Git/TestSubmodule/remote/pr</span><br><span class="line">   42a346a..331116a  master     -&gt; origin/master</span><br><span class="line">Fetching submodule libs/lib1</span><br><span class="line">From D:/Work/Git/TestSubmodule/remote/lib1</span><br><span class="line">   e32323b..ec3c940  master     -&gt; origin/master</span><br><span class="line">Updating 42a346a..331116a</span><br><span class="line">Fast-forward</span><br><span class="line"> libs/lib1 | 2 +-</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看项目状态</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">	modified:   libs/lib1 (new commits)</span><br><span class="line"></span><br><span class="line">no changes added to commit (use <span class="string">"git add"</span> and/or <span class="string">"git commit -a"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看差异</span></span><br><span class="line"><span class="comment"># libs/lib1 第一版为 e3232 第二版为 ec3c9</span></span><br><span class="line"><span class="comment"># 此时索引中指定的为新版 ec3c9 而仓库模块文件还是旧版 e3232</span></span><br><span class="line"><span class="comment"># 可以看出 git 认为的新版本其实是没有来得及更新的旧版</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git diff</span><br><span class="line">diff --git a/libs/lib1 b/libs/lib1</span><br><span class="line">index ec3c940..e32323b 160000</span><br><span class="line">--- a/libs/lib1</span><br><span class="line">+++ b/libs/lib1</span><br><span class="line">@@ -1 +1 @@</span><br><span class="line">-Subproject commit ec3c940c4ab8406b08d0513f02955ca07bb995ef</span><br><span class="line">+Subproject commit e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8</span><br><span class="line"></span><br><span class="line"><span class="comment"># update 将索引中指定的新版的 libs/lib1 模块文件检出</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git submodule update</span><br><span class="line">Submodule path <span class="string">'libs/lib1'</span>: checked out <span class="string">'ec3c940c4ab8406b08d0513f02955ca07bb995ef'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 再看状态已经是干净的了</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>
<h4 id="2-5-2-索引中commit-id未更新"><a href="#2-5-2-索引中commit-id未更新" class="headerlink" title="2.5.2 索引中commit id未更新"></a>2.5.2 索引中commit id未更新</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 由于索引中指定的 commit id 与旧版模块已经对应，因此状态是干净的</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入模块 lib2 目录下并切换到需要的分支</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ <span class="built_in">cd</span> lib2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 因为是初始导入所以分支在master上，但更多的情况下模块处于头指针分离的状态</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/lib2 (master)</span><br><span class="line">$ git checkout master</span><br><span class="line">Already on <span class="string">'master'</span></span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拉取更新</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr/lib2 (master)</span><br><span class="line">$ git pull</span><br><span class="line">remote: Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">Unpacking objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">From D:/Work/Git/TestSubmodule/remote/lib2</span><br><span class="line">   a2b0f7a..772a158  master     -&gt; origin/master</span><br><span class="line">Updating a2b0f7a..772a158</span><br><span class="line">Fast-forward</span><br><span class="line"> l2.md | 1 +</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检出需要的版本</span></span><br><span class="line"><span class="comment"># 用最新版的情况下不需要这一步，拉取后即为最新...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看状态：git 发现模块 lib2 版本发生了变化</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up to date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">	modified:   lib2 (new commits)</span><br><span class="line"></span><br><span class="line">no changes added to commit (use <span class="string">"git add"</span> and/or <span class="string">"git commit -a"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看差异：索引中的旧版 a2b0f 要更新到新版 772a1</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git diff</span><br><span class="line">diff --git a/lib2 b/lib2</span><br><span class="line">index a2b0f7a..772a158 160000</span><br><span class="line">--- a/lib2</span><br><span class="line">+++ b/lib2</span><br><span class="line">@@ -1 +1 @@</span><br><span class="line">-Subproject commit a2b0f7ac5f0f2cfe8f57dd24e7b6ab27922d6d7d</span><br><span class="line">+Subproject commit 772a158c031f55febc383196a5c02eb58c0b13ed</span><br><span class="line"></span><br><span class="line"><span class="comment"># 因为索引中指定的模块版本发生了变化，需要提交</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git commit -am <span class="string">"follow lib2 v0.1 to v0.2 update"</span></span><br><span class="line">[master b5de982] follow lib2 v0.1 to v0.2 update</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git push</span><br><span class="line">Enumerating objects: 3, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 4 threads.</span><br><span class="line">Compressing objects: 100% (2/2), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (2/2), 315 bytes | 315.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 2 (delta 0), reused 0 (delta 0)</span><br><span class="line">To D:/Work/Git/TestSubmodule/remote/pr.git</span><br><span class="line">   331116a..b5de982  master -&gt; master</span><br></pre></td></tr></table></figure>
<h2 id="3-涉及到的知识点"><a href="#3-涉及到的知识点" class="headerlink" title="3.涉及到的知识点"></a>3.涉及到的知识点</h2><h3 id="Git-中的文件模式"><a href="#Git-中的文件模式" class="headerlink" title="Git 中的文件模式"></a>Git 中的文件模式</h3><p>From the Git <a href="https://github.com/git/git/blob/master/Documentation/technical/index-format.txt" target="_blank" rel="noopener">index-format.txt</a> file, regarding the mode:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">32-bit mode, split into (high to low bits)</span><br><span class="line"></span><br><span class="line">    4-bit object type</span><br><span class="line">      valid values in binary are 1000 (regular file), 1010 (symbolic link)</span><br><span class="line">      and 1110 (gitlink)</span><br><span class="line"></span><br><span class="line">    3-bit unused</span><br><span class="line"></span><br><span class="line">    9-bit unix permission. Only 0755 and 0644 are valid for regular files.</span><br><span class="line">    Symbolic links and gitlinks have value 0 in this field.</span><br></pre></td></tr></table></figure>
<p>Also, a directory object type (binary 0100) and group-writeable (0664 permissions) regular file are allowed as indicated by the fsck.c fsck_tree method. The regular non-executable group-writeable file is a non-standard mode that was supported in earlier versions of Git.</p>
<blockquote>
<p>此外，允许目录对象类型（二进制0100）和组可写（0664权限）常规文件，如fsck.c fsck_tree方法所示。 常规的非可执行组可写文件是早期版本的Git支持的非标准模式。</p>
</blockquote>
<p>This makes valid modes (as binary and octal):</p>
<blockquote>
<p>这使得有效模式（二进制和八进制）：</p>
</blockquote>
<p>0100000000000000 (040000): Directory</p>
<p>1000000110100100 (100644): Regular non-executable file</p>
<p>1000000110110100 (100664): Regular non-executable group-writeable file</p>
<p>1000000111101101 (100755): Regular executable file</p>
<p>1010000000000000 (120000): Symbolic link</p>
<p>1110000000000000 (160000): Gitlink</p>
<blockquote>
<p>0100000000000000（040000）：目录</p>
<p>1000000110100100（100644）：常规非可执行文件</p>
<p>1000000110110100（100664）：常规非可执行组可写文件</p>
<p>1000000111101101（100755）：常规可执行文件</p>
<p>1010000000000000（120000）：符号链接</p>
<p>1110000000000000（160000）：Gitlink</p>
</blockquote>
<ul>
<li>这里的文件模式参考了常见的 UNIX 文件模式，但远没那么灵活。</li>
</ul>
<h3 id="查看gitlink"><a href="#查看gitlink" class="headerlink" title="查看gitlink"></a>查看gitlink</h3><blockquote>
<p>以 2.x 中的几个仓库为例，因为在 pr 引入 Submodule 后的提交中开始存在 gitlink ，而 pr 在最后一个版本相对前一版本更新了 lib2 的版本，所以此处选择 pr 最后两个版本进行对比查看。</p>
</blockquote>
<h4 id="lib1-lib2-pr-的-git-log"><a href="#lib1-lib2-pr-的-git-log" class="headerlink" title="lib1 lib2 pr 的 git log"></a>lib1 lib2 pr 的 git log</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lib1 的 git log</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule</span><br><span class="line">$ <span class="built_in">cd</span> libs/lib1</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit ec3c940c4ab8406b08d0513f02955ca07bb995ef (HEAD -&gt; master, origin/master)</span><br><span class="line">Author: pr-clone/libs/lib1 &lt;pr-clone/libs/lib1@&gt;</span><br><span class="line">Date:   Sat Aug 18 16:17:49 2018 +0800</span><br><span class="line"></span><br><span class="line">    IN pr-clone: update lib1 to 0.2</span><br><span class="line"></span><br><span class="line">commit e32323bc96b2e9753ba740e0efbed4a4fe2c0fc8</span><br><span class="line">Author: lib1 &lt;lib1@&gt;</span><br><span class="line">Date:   Fri Aug 17 21:59:54 2018 +0800</span><br><span class="line"></span><br><span class="line">    init lib1 v0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># lib2 的 git log</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib1 (master)</span><br><span class="line">$ <span class="built_in">cd</span> ../lib2</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib2 (master)</span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit 772a158c031f55febc383196a5c02eb58c0b13ed (HEAD -&gt; master, origin/master)</span><br><span class="line">Author: lib2 &lt;lib2@&gt;</span><br><span class="line">Date:   Sat Aug 18 18:43:26 2018 +0800</span><br><span class="line"></span><br><span class="line">    IN selfRepo update lib2 to 0.2</span><br><span class="line"></span><br><span class="line">commit a2b0f7ac5f0f2cfe8f57dd24e7b6ab27922d6d7d</span><br><span class="line">Author: lib2 &lt;lib2@&gt;</span><br><span class="line">Date:   Fri Aug 17 22:05:13 2018 +0800</span><br><span class="line"></span><br><span class="line">    init lib2 v0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># pr 的 git log</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/libs/lib2 (master)</span><br><span class="line">$ <span class="built_in">cd</span> ../../pr</span><br><span class="line"></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit b5de982213428040683bd765cda5dae5303a6a24 (HEAD -&gt; master, origin/master)</span><br><span class="line">Author: pr &lt;pr@&gt;</span><br><span class="line">Date:   Sat Aug 18 19:30:54 2018 +0800</span><br><span class="line"></span><br><span class="line">    follow lib2 v0.1 to v0.2 update</span><br><span class="line"></span><br><span class="line">commit 331116ad97463cf9c7e69a2112cf19e1bbda1976</span><br><span class="line">Author: pr-clone &lt;pr-clone@&gt;</span><br><span class="line">Date:   Sat Aug 18 18:32:56 2018 +0800</span><br><span class="line"></span><br><span class="line">    follow lib1 v0.1 to v0.2 update</span><br><span class="line"></span><br><span class="line">commit 42a346aad4e27743984d40e9cc9f1dcf6606ee40</span><br><span class="line">Author: pr &lt;pr@&gt;</span><br><span class="line">Date:   Sat Aug 18 14:59:01 2018 +0800</span><br><span class="line"></span><br><span class="line">    import: lib1 to ./libs/lib1, lib2 to ./lib2 (default path)</span><br><span class="line"></span><br><span class="line">commit 48f1fd848327868b056e5088e975cafad13e46b9</span><br><span class="line">Author: pr &lt;pr@&gt;</span><br><span class="line">Date:   Sat Aug 18 13:46:03 2018 +0800</span><br><span class="line"></span><br><span class="line">    init pr v0.1</span><br></pre></td></tr></table></figure>
<h4 id="pr-的倒数第二次提交"><a href="#pr-的倒数第二次提交" class="headerlink" title="pr 的倒数第二次提交"></a>pr 的倒数第二次提交</h4><blockquote>
<p>先看更新 lib2 之前的提交 331116ad97463cf9c7e69a2112cf19e1bbda1976</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显然这是一个commit类型的对象</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git cat-file -t 331116ad97463cf9c7e69a2112cf19e1bbda1976</span><br><span class="line">commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看内容，得到此提交指向的目录树 tree 19a1795ef10408f533c194b9d799941eb59f9139</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git cat-file -p 331116ad97463cf9c7e69a2112cf19e1bbda1976</span><br><span class="line">tree 19a1795ef10408f533c194b9d799941eb59f9139</span><br><span class="line">parent 42a346aad4e27743984d40e9cc9f1dcf6606ee40</span><br><span class="line">author pr-clone &lt;pr-clone@&gt; 1534588376 +0800</span><br><span class="line">committer pr-clone &lt;pr-clone@&gt; 1534588376 +0800</span><br><span class="line"></span><br><span class="line">follow lib1 v0.1 to v0.2 update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看这棵树，可以看到 lib2 的文件模式为 160000 类型为 commit</span></span><br><span class="line"><span class="comment"># 对比上方 lib2 的 git log ，这串 hash码 就是 lib2 第一次提交的commit id</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git cat-file -p 19a1795ef10408f533c194b9d799941eb59f9139</span><br><span class="line">100644 blob 7896297258c3b7833205c80ff7aa7843bf1a07ae    .gitmodules</span><br><span class="line">160000 commit a2b0f7ac5f0f2cfe8f57dd24e7b6ab27922d6d7d  lib2</span><br><span class="line">040000 tree 6c0d205680346cdd41957147913cba2ff5627f8b    libs</span><br><span class="line">100644 blob eeeb88dcb36d4578b9a1d2c4fdba3b7e36428bcd    p.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看文件模式为 040000 的 libs 可以看到 lib1 像 lib2 一样</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git cat-file -p 6c0d205680346cdd41957147913cba2ff5627f8b</span><br><span class="line">160000 commit ec3c940c4ab8406b08d0513f02955ca07bb995ef  lib1</span><br></pre></td></tr></table></figure>
<h4 id="pr-的最后一次提交"><a href="#pr-的最后一次提交" class="headerlink" title="pr 的最后一次提交"></a>pr 的最后一次提交</h4><blockquote>
<p>再来看 pr 更新 lib2 后的提交 b5de982213428040683bd765cda5dae5303a6a24</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接查看它的目录树</span></span><br><span class="line"><span class="comment"># 对比上方 lib2 的 git log</span></span><br><span class="line"><span class="comment"># 可以看到文件模式为 160000 类型为 commit 的 lib2 这一行</span></span><br><span class="line"><span class="comment"># 中的 hash码 变为了 lib2 更新后提交的 commit id</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git ls-tree b5de982213428040683bd765cda5dae5303a6a24</span><br><span class="line">100644 blob 7896297258c3b7833205c80ff7aa7843bf1a07ae    .gitmodules</span><br><span class="line">160000 commit 772a158c031f55febc383196a5c02eb58c0b13ed  lib2</span><br><span class="line">040000 tree 6c0d205680346cdd41957147913cba2ff5627f8b    libs</span><br><span class="line">100644 blob eeeb88dcb36d4578b9a1d2c4fdba3b7e36428bcd    p.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同样的命令查看 libs</span></span><br><span class="line"><span class="comment"># 可以看到 lib1 对应的 hash码 没有改变，因为 pr 的这次提交相对于</span></span><br><span class="line"><span class="comment"># 上一次提交没有改变 lib1 的版本</span></span><br><span class="line">MiK@MiK-PC MINGW64 /d/Work/Git/TestSubmodule/pr (master)</span><br><span class="line">$ git ls-tree 6c0d205680346cdd41957147913cba2ff5627f8b</span><br><span class="line">160000 commit ec3c940c4ab8406b08d0513f02955ca07bb995ef  lib1</span><br></pre></td></tr></table></figure>
<h3 id="总结流程"><a href="#总结流程" class="headerlink" title="总结流程"></a>总结流程</h3><p>本文中涉及到过的文件模式 160000 的解释为 gitlink ，意为一个git的链接，可以认为是指向一个commit id，在项目A中引入另一个项目B作为Submodule时，A不对引入的B的文件进行版本控制，而是在索引中用 gitlink 记录本项目下某个目录对应B的某一个版本的commit id</p>
<p>当一个项目使用 git submodule add 引入一个 Submodule 时，会在项目中生成记录模块信息的 .gitmodules 文件并注册到 .git/config 中，根据指定的目录clone模块版本库到 .git/modules 并检出到指定目录，该目录被索引记录为 gitlink 指向模块当前版本commit id。</p>
<p>当一个引入了Submodule的项目被检出时会创建每个模块在项目中的目录，并有一个被版本控制的 .gitmodules 文件记录着每个模块在当前项目的path及来源url。</p>
<p>执行 git submodule init 命令时，模块会被注册到 .git/config 中。</p>
<p>执行 git submodule update命令时，git会根据已注册模块的url来clone该模块版本库参考path存到 .git/modules 中并检出 gitlink 记录的版本到对应目录下。</p>
<h2 id="感谢两大搜索引擎提供了强大的中英文资料支持-amp-Google-翻译"><a href="#感谢两大搜索引擎提供了强大的中英文资料支持-amp-Google-翻译" class="headerlink" title="感谢两大搜索引擎提供了强大的中英文资料支持 &amp; Google 翻译"></a>感谢两大搜索引擎提供了强大的中英文资料支持 &amp; Google 翻译</h2>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/Git/" rel="tag"># Git</a>
          
            <a href="/blog/tags/Submodule/" rel="tag"># Submodule</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2018/12/13/First-Post/" rel="prev" title="First Post">
                First Post <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">MiK</p>
              <p class="site-description motion-element" itemprop="description">MiKの试验田</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/blog/tags/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/blog/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-对于共用资源的处理方式（为什么要使用Git-Submodule？）"><span class="nav-number">1.</span> <span class="nav-text">1.对于共用资源的处理方式（为什么要使用Git Submodule？）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-如何使用Git-Submodule"><span class="nav-number">2.</span> <span class="nav-text">2.如何使用Git Submodule</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-准备工作"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 准备工作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-建立三个版本库"><span class="nav-number">2.1.1.</span> <span class="nav-text">2.1.1 建立三个版本库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-建立lib1，lib2，pr本地仓库"><span class="nav-number">2.1.2.</span> <span class="nav-text">2.1.2 建立lib1，lib2，pr本地仓库</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-在项目中添加Submodules"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 在项目中添加Submodules</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-添加Submodules"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.2.1 添加Submodules</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-观察变化"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2.2 观察变化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3-commit-amp-push"><span class="nav-number">2.2.3.</span> <span class="nav-text">2.2.3 commit &amp; push</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Clone带有Submodules的项目（仓库）"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 Clone带有Submodules的项目（仓库）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-git-clone"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.3.1 git clone</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-查看Submodules状态"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.3.2 查看Submodules状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-注册并检出模块"><span class="nav-number">2.3.3.</span> <span class="nav-text">2.3.2 注册并检出模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-修改Submodule"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 修改Submodule</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-在引用了该模块的项目中修改（lib1为例）"><span class="nav-number">2.4.1.</span> <span class="nav-text">2.4.1 在引用了该模块的项目中修改（lib1为例）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-在模块（项目）自己的仓库中修改（lib2为例）"><span class="nav-number">2.4.2.</span> <span class="nav-text">2.4.2 在模块（项目）自己的仓库中修改（lib2为例）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-应用Submodule的修改"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 应用Submodule的修改</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-1-索引中commit-id已更新"><span class="nav-number">2.5.1.</span> <span class="nav-text">2.5.1 索引中commit id已更新</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-2-索引中commit-id未更新"><span class="nav-number">2.5.2.</span> <span class="nav-text">2.5.2 索引中commit id未更新</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-涉及到的知识点"><span class="nav-number">3.</span> <span class="nav-text">3.涉及到的知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Git-中的文件模式"><span class="nav-number">3.1.</span> <span class="nav-text">Git 中的文件模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看gitlink"><span class="nav-number">3.2.</span> <span class="nav-text">查看gitlink</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#lib1-lib2-pr-的-git-log"><span class="nav-number">3.2.1.</span> <span class="nav-text">lib1 lib2 pr 的 git log</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pr-的倒数第二次提交"><span class="nav-number">3.2.2.</span> <span class="nav-text">pr 的倒数第二次提交</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pr-的最后一次提交"><span class="nav-number">3.2.3.</span> <span class="nav-text">pr 的最后一次提交</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结流程"><span class="nav-number">3.3.</span> <span class="nav-text">总结流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#感谢两大搜索引擎提供了强大的中英文资料支持-amp-Google-翻译"><span class="nav-number">4.</span> <span class="nav-text">感谢两大搜索引擎提供了强大的中英文资料支持 &amp; Google 翻译</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">MiK</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/blog/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
